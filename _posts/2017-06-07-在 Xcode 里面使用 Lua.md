---
layout: post
title:  "åœ¨ Xcode é‡Œé¢ä½¿ç”¨ Lua"
date:   2017-06-07 22:35:30 +0800
categories: jekyll update
---

å…³æ³¨åˆ° Luaï¼Œæ˜¯æºäºçœ‹åˆ°ä¸€ä¸ª [ã€Šæœ€å€¼å¾—é˜…è¯»å­¦ä¹ çš„ 10 ä¸ª C è¯­è¨€å¼€æºé¡¹ç›®ä»£ç ã€‹](http://blog.jobbole.com/79023/) çš„ postï¼Œé‡Œé¢æåˆ° Lua è¿™ä¸ªé¡¹ç›®ï¼Œç„¶åå°±æƒ³ç€å»çœ‹çœ‹ Lua çš„æºç ï¼Œå¤§æ¦‚è¿™æ ·ã€‚

ç²—ç•¥è¿‡äº†ä¸€ä¸‹äº‘é£å¤§ç¥çš„ã€ŠLua æºç æ¬£èµã€‹ï¼Œæƒ³ç€è‡ªå·±æ€ä¹ˆå¼€å§‹ï¼Œç„¶åå°±æœ‰ç€åœ¨ Xcode å»ºäº†ä¸€ä¸ª C Projectï¼Œç„¶åè°ƒç”¨ Lua ä»£ç çš„æƒ³æ³•ï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ç¯‡åšå®¢ï¼Œä½†å…¶å®ä¹Ÿåªæ˜¯æ‹¾äººç‰™æ…§ï¼Œä¸»è¦ä¾›è‡ªå·±ä»¥åå‚è€ƒã€‚

* ä½¿ç”¨ Xcode æ–°å»ºä¸€ä¸ª C Projectï¼Œåœ¨ `File > New > Project` ä¸‹æ–°å»ºä¸€ä¸ª Projectã€‚ä½†æ˜¯æ–°å»ºçš„æ˜¯ `macOS` ä¸‹çš„ `Command Line Tool`ã€‚å…¶å®ƒçš„å°±è·Ÿä½ æ–°å»ºé¡¹ç›®ä¸€æ ·äº†ï¼Œå¹¶æ— å¤ªç‰¹åˆ«çš„åœ°æ–¹ã€‚

 ![macOS-command-line-tool.png](/images/macOS-command-line-tool.png)

* ç„¶åå¯ä»¥æŠŠ [Simple Lua Api Example](http://lua-users.org/wiki/SimpleLuaApiExample) çš„ C ä»£ç å¤åˆ¶åˆ° `main.c`ã€‚ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä¼šæŠŠ `status = luaL_loadfile(L, "script.lua");` æ”¹æˆ `status = luaL_loadstring(L, "print('a')");`ã€‚

* è¿™ä¸ªæ—¶å€™ï¼Œä½ å°±ä¼šå‘ç°åœ¨ include é‚£äº›åœ°æ–¹æŠ¥é”™äº†ï¼Œåœ¨å‘½ä»¤è¡Œç¯å¢ƒä¸‹ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥è¿™ä¹ˆæ‰§è¡Œçš„ `gcc -o test test.c -I/Users/Roger/.asdf/installs/lua/5.3.3/include -L/Users/Roger/.asdf/installs/lua/5.3.3/lib -llua -lm`(æˆ‘ä½¿ç”¨ asdf åšç‰ˆæœ¬ç®¡ç†)ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è§£å†³æ€ä¹ˆæŠŠ Lua çš„å¤´æ–‡ä»¶ï¼Œåº“åŠ åˆ° Xcode é‡Œé¢ã€‚å¯ä»¥å‚è€ƒ [How to Link C++ Librares in XCode [Specifically Magick++]](https://www.youtube.com/watch?v=7miwnp8iDm8) æ¥æŠŠå‘½ä»¤è¡Œçš„è®¾ç½®åŠ åˆ° Xcode é‡Œé¢å°±å¯ä»¥äº†ã€‚ç®€å•æ¥è¯´å°±æ˜¯å¢åŠ  Xcode Build Setting é‡Œé¢çš„ `Header Search Paths`ï¼Œ`Library Search Paths` å’Œ `Other Linker Flags`ï¼Œå¦‚ä¸‹é¢ä¸¤å¼ å›¾æ‰€ç¤ºã€‚

 ![Lua-Search-path.png](/images/Lua-Search-path.png)

 ![Lua-Linking-flag.png](/images/Lua-Linking-flag.png)

* æœ€åï¼Œæ•´ä¸ªé¡¹ç›®å°±å¯ä»¥è·‘èµ·æ¥äº†ğŸ˜
